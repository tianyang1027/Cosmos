detrimental_feature =
    EXTRACT murl : string,
            purl : string,
            label : string,
            DocKey : string,
            Vector : string,
            TenantId : string,
            Date : string
    FROM "/shares/SegmentRelevance/SegmentRelevance/Prod/Image/SparkSchedulingSupport/Prism/HitApp/RacyFeature/2023_02_19/detrimental_feature.tsv"
    USING DefaultTextExtractor();


detrimental_feature1 =
    SELECT murl,
           purl,
           "promoting_violence" AS label,
           DocKey,
           Vector,
           TenantId,
           Date
    FROM detrimental_feature
    WHERE murl IN("https://i.dailymail.co.uk/i/pix/2016/10/10/14/394823F600000578-0-image-a-115_1476107422817.jpg");

detrimental_feature2 =
    SELECT *
    FROM detrimental_feature
    WHERE murl NOT IN("https://i.dailymail.co.uk/i/pix/2016/10/10/14/394823F600000578-0-image-a-115_1476107422817.jpg");


result =
    SELECT *
    FROM detrimental_feature1
    UNION
    SELECT *
    FROM detrimental_feature2;

OUTPUT
TO "/shares/SegmentRelevance/SegmentRelevance/Prod/Image/SparkSchedulingSupport/Prism/HitApp/RacyFeature/2023_02_19/detrimental_feature.tsv"
USING DefaultTextOutputter(outputHeader: true);